<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <title>Python3中Excel文件的处理</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">my github blog </a></h1>
                <nav><ul>
                    <li><a href="/category/blog_admin.html">blog_admin</a></li>
                    <li class="active"><a href="/category/python.html">python</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/python3zhong-excelwen-jian-de-chu-li.html" rel="bookmark"
           title="Permalink to Python3中Excel文件的处理">Python3中Excel文件的处理</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2019-08-31T21:35:00+02:00">
                Published: 六 31 八月 2019
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/admin.html">admin</a>
        </address>
<p>In <a href="/category/python.html">python</a>.</p>

</footer><!-- /.post-info -->      <ul>
<li>
<p>xlrd读取文件</p>
<p>xlrd是跨平台的，主要示例代码如下：</p>
<p><code>python {.line-numbers}
workbook_object = xlrd.open_workbook(report_path) #打开文件,获取workbook对象
work_sheet = workbook_object.sheet_by_name("Sheet1")#基于sheet名字获取到sheet对象
the_sheet.cell(7,3).ctype#获取单元格的类型</code>
使用<code>work_sheet.nrows</code>获取行数，使用<code>cell_value(i,j)</code>获取某个格子的值</p>
<p>python读取excel中单元格的内容返回的有6种类型:
+ 0 empty
+ 1 string
+ 2 number
+ 3 date
+ 4 boolean
+ 5 error</p>
</li>
<li>
<p>xlwings的使用</p>
<p>根据目前的研究，xlwings很可能是调用了Excel VBA API，从代码被调用时打开了Excel程序实例来看应该是这样，这也意味着它可以做到更加复杂的操作。部分示例代码如下：</p>
<p><code>python {.line-numbers}
the_workbook=xw.Book(template_path) #打开文件,获取workbook对象
detail_sheet=xw.Sheet("Sheet1") #sheet名字
detail_sheet.range(str(i+6)+':'+str(i+6)).api.Insert()#利用Excel VBA API插入新的行
detail_sheet.range(i+6,j+1).value = the_line[j]#给某个格子填写内容，注意第1个格子A1是1,1
detail_sheet.range('5:5').api.EntireRow.Delete()#删掉一行，此处是删除掉第5行
the_workbook.app.quit()#用这个方法来退出Excel程序，the_workbook.close()只能关掉当前打开的文件</code></p>
</li>
<li>
<p>xlwt的使用</p>
<p>在有xlwings的情况下还要用xlwt，主要的原因是：</p>
<ul>
<li>
<p>xlwings不支持Linux（Linux下面没有 MS Office）</p>
</li>
<li>
<p>xlwt更加简单</p>
</li>
</ul>
<p>注意：xlwt目前没有办法通过模板来进行写入，所以落入了下乘</p>
<p>主要代码示例如下：</p>
<p><code>python {.line-numbers}
style = xlwt.XFStyle() # 初始化样式
font = xlwt.Font() # 为样式创建字体
font.name = 'Times New Roman' 
font.bold = True # 黑体
font.underline = True # 下划线
font.italic = True # 斜体字
style.font = font # 设定样式
worksheet.write(0, 0, 'Unformatted value') # 不带样式的写入
worksheet.write(1, 0, 'Formatted value', style) # 带样式的写入
workbook.save('formatting.xls') # 保存文件</code>
+ 参考资料</p>
<ul>
<li><a href="https://www.jianshu.com/p/4e39444d5ebc">python使用xlwt模块操作Excel</a></li>
</ul>
</li>
</ul>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="http://getpelican.com/">Pelican</a></li>
                            <li><a href="http://python.org/">Python.org</a></li>
                            <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>